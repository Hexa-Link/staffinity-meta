# .github/workflows/setup_sprint.yml
name: "Setup Sprint Issues from YML"

# This allows running the workflow manually from the "Actions" tab
on:
  workflow_dispatch:
    inputs:
      sprint_file:
        description: 'Path to the YML file to use for sprint setup'
        required: true
        default: 'sprint_setup.yml'

jobs:
  create-sprint-issues:
    runs-on: ubuntu-latest
    permissions:
      # This permission is required so the script can create issues in the organization's repositories
      issues: write
      contents: read
    
    steps:
      - name: "1. Checkout repository code"
        uses: actions/checkout@v4

      - name: "2. Set up Python"
        uses: actions/setup-python@v5
        with:
          python-version: '3.10'

      - name: "3. Install Python dependencies"
        run: pip install PyYAML requests

      - name: "4. Run script to create issues"
        env:
          # GITHUB_TOKEN is provided automatically by GitHub Actions.
          # It has permissions to act on behalf of the user who triggers the action.
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: python scripts/create_issues.py ${{ github.event.inputs.sprint_file }}